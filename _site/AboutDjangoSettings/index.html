<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js" xmlns:wb="http://open.weibo.com/wb">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>关于Django-Settings.py的一些事 – externIE</title> <meta name="description" content="externIE的个人博客"> <meta name="keywords" content="python, django, settings"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="/assets/img/logo.png"> <meta name="twitter:title" content="关于Django-Settings.py的一些事"> <meta name="twitter:description" content="关于Django-Settings看这篇就够了"> <!-- Open Graph --> <meta property="og:locale" content=""> <meta property="og:type" content="article"> <meta property="og:title" content="关于Django-Settings.py的一些事"> <meta property="og:description" content="关于Django-Settings看这篇就够了"> <meta property="og:url" content="/AboutDjangoSettings/"> <meta property="og:site_name" content="externIE"> <meta property="og:image" content="/assets/img/logo.png"> <link rel="canonical" href="/AboutDjangoSettings/"> <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="externIE Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="/assets/css/main.css"> <!-- JS --> <script src="/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="/favicon.png"> <link rel="shortcut icon" href="/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> <meta property="wb:webmaster" content="dcf4f3271ee3aab8"> <script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">菜单</button> <ul class="dl-menu"> <li><a href="/">首页</a></li> <li> <a href="#">关于</a> <ul class="dl-submenu"> <li> <img src="/assets/img/logo.png" alt="externIE photo" class="author-photo"> <h4>externIE</h4> <p>externIE的个人博客</p> </li> <li><a href="/about/"><span class="btn btn-inverse">了解更多</span></a></li> <li> <a href="mailto:externie@outlook.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://github.com/externIE" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> <li> <a href="http://www.weibo.com/ielinyikai" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-weibo"></i> 微博</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">博文</a> <ul class="dl-submenu"> <li><a href="/posts/">所有博文</a></li> <li><a href="/tags/">所有类别</a></li> </ul> </li> <li><a href="/projects/">项目</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>关于Django-Settings.py的一些事</h1> <h4>29 Nov 2016</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~1 minute </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h2 id="django-settings-">Django settings 概述</h2> <p>Django settings是个神奇的py文件，它包含了整个django站点的相关设置，其可选项是很多的，采用import * 覆写的方式，配置属于自己的站点，也就是说其实django本来就已经管理有一份默认的settings配置。 这份文件基本上决定了你的服务器是否要输出调试信息，采用什么数据库，站点内都有什么app，有什么中间件，你也可以自定义一些字段，以便全站使用。所以这分文件是及其重要的，也是及其私密的，不可随意公开。</p> <h2 id="section">一些基本知识</h2> <p>settings文件其实就是一个python带模块级别变量的模块罢了。 下面是一些常见的配置：</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">ALLOWED_HOSTS</span> <span class="o">=</span> <span class="p">[</span><span class="s">'www.externie.com'</span><span class="p">]</span>
<span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">DEFAULT_FROM_EMAIL</span> <span class="o">=</span> <span class="s">'xxx@163.com'</span></code></pre></figure> <p class="notice"><strong>注意!</strong> 如果DEBUG==False那么ALLOWE_HOSTS就一定要有值，不能是空数组</p> <p>由于settings文件其实是个python模块，所以它也具备python模块的一些特性： * 不能有python语法错误 * 可以用正确的python语句给settings动态赋值，如下：</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">MY_SETTING</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">)]</span></code></pre></figure> <ul> <li>你也可以从其它的settings文件中导入（import）一些变量</li> </ul> <h2 id="settings">指定使用哪份settings文件</h2> <p>### DJANGO_SETTINGS_MODULE 当你在用django的时候，你必须告诉django你需要用的settings文件。这时候就需要用上<code class="highlighter-rouge">DJANGO_SETTINGS_MODULE</code>这个环境变量。</p> <p>DJANGO_SETTINGS_MODULE需要用python的点路径，比如<code class="highlighter-rouge">e.g.mysite.settings</code>。当然了settings这个文件必须在python的搜索路径下，换句话说就是sys.path数组中一定要有你要用的settings模块的路径。</p> <h3 id="django-admin">django-admin</h3> <p>当你在用django-admin的时候，你也可以只设置一次<code class="highlighter-rouge">DJANGO_SETTINGS_MODULE</code>就可以了，之后你的每次运行，django-admin都会使用你所设置的settings文件。</p> <p>例子（类Unix）：</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">export</span> <span class="n">DJANGO_SETTINGS_MODULE</span> <span class="o">=</span> <span class="n">mysite</span><span class="o">.</span><span class="n">settings</span>
<span class="n">django</span><span class="o">-</span><span class="n">admin</span> <span class="n">runserver</span></code></pre></figure> <p>例子（windows）：</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="nb">set</span> <span class="n">DJANGO_SETTINGS_MODULE</span> <span class="o">=</span> <span class="n">mysite</span><span class="o">.</span><span class="n">settings</span>
<span class="n">django</span><span class="o">-</span><span class="n">admin</span> <span class="n">runserver</span></code></pre></figure> <p>当然你也可以用–settings命令行来指定当前需要的特定的settings文件，如下：</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">django</span><span class="o">-</span><span class="n">admin</span> <span class="n">runserver</span> <span class="o">--</span><span class="n">settings</span><span class="o">=</span><span class="n">mysite</span><span class="o">.</span><span class="n">settings</span></code></pre></figure> <h3 id="section-1">动态指定</h3> <p>在你的动态服务器环境下，你需要告诉WSGI应用当前用的是那一份settings文件，你可以这么做：</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'DJANGO_SETTINGS_MODULE'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'mysite.settings'</span></code></pre></figure> <p><a href="https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/">关于Django mod_wsgi的文档</a></p> <h2 id="settings-1">默认的settings文件</h2> <p class="notice">一份settings文件中的一些字段如果你不需要配置的，你完全可以不写出来，因为django会有一份默认的settings文件，它包含了一些默认值，如果你没有重写这些字段的话就会是默认值。 这份更加神奇的settings文件在django/conf/global_settings.py ** 关于settings的“继承机制”： * 先从global_settings.py中加载所有配置 * 再加载你指定的settings文件，并根据你的settings中的内容覆盖global_settings中的一些字段 <strong>注意!</strong> 你并不需要在自己的settings文件中import global_settings，django已经帮你做好了</p> <h2 id="section-2">未完待续。。。。</h2> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="/tags/#python" title="Pages tagged python" class="tag"><span class="term">python</span></a><a href="/tags/#django" title="Pages tagged django" class="tag"><span class="term">django</span></a><a href="/tags/#settings" title="Pages tagged settings" class="tag"><span class="term">settings</span></a></span> <span class="social-share"> <a href="http://v.t.sina.com.cn/share/share.php?appkey=xxxx&amp;url=/AboutDjangoSettings/&amp;title=%E5%85%B3%E4%BA%8EDjango-Settings.py%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BA%8B" title="Share on Google+" class="tag"> <span class="term">分享到新浪微博</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section> <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div> <script> var cloudTieConfig = { url: document.location.href, sourceId: "", productKey: "286839201e3b4f689cbb3c57a0504f7d", target: "cloud-tie-wrapper" }; </script> <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script> </section> </header> <!-- JS --> <script src="/assets/js/jquery-1.12.0.min.js"></script> <script src="/assets/js/jquery.dlmenu.min.js"></script> <script src="/assets/js/jquery.goup.min.js"></script> <script src="/assets/js/jquery.magnific-popup.min.js"></script> <script src="/assets/js/jquery.fitvid.min.js"></script> <script src="/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'externie'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
